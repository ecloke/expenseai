(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[865],{41418:function(e,t,r){Promise.resolve().then(r.bind(r,37300))},37300:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return k}});var s=r(57437),a=r(2265),l=r(99376),n=r(2141),i=r(4125),o=r(62869),c=r(95186),d=r(26815),u=r(66070),h=r(11239),m=r(82023),x=r(39763);let y=(0,x.Z)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);var f=r(31047),g=r(91723);let p=(0,x.Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);var b=r(89912),w=r(40257);class j{async getExpenses(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{searchTerm:r,categoryFilter:s,projectFilter:a,dateRange:l,customStartDate:n,customEndDate:i,limit:o=20,offset:c=0}=t,d=this.supabase.from("expenses").select("*, projects(name, currency)",{count:"exact"}).eq("user_id",e).order("receipt_date",{ascending:!1});r&&(d=d.ilike("store_name","%".concat(r,"%"))),s&&"all"!==s&&(d=d.eq("category",s)),"general"===a?d=d.is("project_id",null):a&&"all"!==a&&(d=d.eq("project_id",a)),"week"===l?d=d.gte("receipt_date",(0,b.YM)(7)):"month"===l?d=d.gte("receipt_date",(0,b.S8)()):"custom"===l&&(n&&(d=d.gte("receipt_date",(0,b.Gv)(n))),i&&(d=d.lte("receipt_date",(0,b.Gv)(i))));let{data:u,error:h,count:m}=await d.range(c,c+o-1);if(h)throw h;return{data:u||[],count:m||0}}async getExpensesByDateRange(e,t,r){let{data:s,error:a}=await this.supabase.from("expenses").select("*").eq("user_id",e).gte("receipt_date",t).lte("receipt_date",r).order("receipt_date",{ascending:!1});if(a)throw a;return s||[]}async getTodayExpenses(e){let t=(0,b.TS)();return this.getExpensesByDateRange(e,t,t)}async getYesterdayExpenses(e){let t=(0,b.T5)();return this.getExpensesByDateRange(e,t,t)}async getWeekExpenses(e){let t=(0,b.ln)(),r=(0,b.TS)();return this.getExpensesByDateRange(e,t,r)}async getMonthExpenses(e){let t=(0,b.S8)(),r=(0,b.TS)();return this.getExpensesByDateRange(e,t,r)}async createExpense(e,t){let{data:r,error:s}=await this.supabase.from("expenses").insert([{user_id:e,receipt_date:t.receiptDate,store_name:t.storeName,category:t.category,total_amount:t.totalAmount,project_id:t.projectId||null,created_at:new Date().toISOString()}]).select().single();if(s)throw s;return r}async updateExpense(e,t,r){let{data:s,error:a}=await this.supabase.from("expenses").update(r).eq("id",t).eq("user_id",e).select().single();if(a)throw a;return s}async deleteExpense(e,t){let{error:r}=await this.supabase.from("expenses").delete().eq("id",t).eq("user_id",e);if(r)throw r}async getExpenseStats(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"month",r=this.supabase.from("expenses").select("category, total_amount").eq("user_id",e);"week"===t?r=r.gte("receipt_date",(0,b.YM)(7)):"month"===t?r=r.gte("receipt_date",(0,b.S8)()):"year"===t&&(r=r.gte("receipt_date",(0,b.YM)(365)));let{data:s,error:a}=await r;if(a)throw a;let l=s||[],n=l.reduce((e,t)=>e+parseFloat(t.total_amount),0),i=l.length,o={};l.forEach(e=>{let t=e.category;o[t]=(o[t]||0)+parseFloat(e.total_amount)});let c=Object.entries(o).map(e=>{let[t,r]=e;return{category:t,amount:parseFloat(r.toFixed(2)),percentage:n>0?parseFloat((r/n*100).toFixed(1)):0}}).sort((e,t)=>t.amount-e.amount);return{total:parseFloat(n.toFixed(2)),count:i,categories:c}}constructor(){this.supabase=(0,n.J)()}}class N{async getProjects(e){let{data:t,error:r}=await this.supabase.from("projects").select("*").eq("user_id",e).order("created_at",{ascending:!1});if(r)throw r;return t||[]}async createProject(e,t){let{data:r,error:s}=await this.supabase.from("projects").insert([{user_id:e,name:t.name,currency:t.currency,status:"open",created_at:new Date().toISOString()}]).select().single();if(s)throw s;return r}async updateProject(e,t,r){let{data:s,error:a}=await this.supabase.from("projects").update(r).eq("id",t).eq("user_id",e).select().single();if(a)throw a;return s}async deleteProject(e,t){let{error:r}=await this.supabase.from("projects").delete().eq("id",t).eq("user_id",e);if(r)throw r}constructor(){this.supabase=(0,n.J)()}}class v{async getSession(){return await this.supabase.auth.getSession()}async signIn(e,t){return await this.supabase.auth.signInWithPassword({email:e,password:t})}async signUp(e,t){return await this.supabase.auth.signUp({email:e,password:t})}async signOut(){return await this.supabase.auth.signOut()}constructor(){this.supabase=(0,n.J)()}}class D{async post(e,t){let r=await fetch("".concat(this.baseUrl,"/api").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),s=await r.json();if(!r.ok)throw Error(s.error||"API request failed");return s}async get(e){let t=await fetch("".concat(this.baseUrl,"/api").concat(e)),r=await t.json();if(!t.ok)throw Error(r.error||"API request failed");return r}constructor(){this.baseUrl=w.env.NEXT_PUBLIC_BACKEND_URL||"http://localhost:3000"}}new j,new N,new v;let _=new D;function k(){let e=(0,l.useRouter)(),[t,r]=(0,a.useState)(null),[x,b]=(0,a.useState)(!0),[w,j]=(0,a.useState)({birthDate:"",birthTime:"",birthPlace:""}),[N,v]=(0,a.useState)(!1),[D,k]=(0,a.useState)(null),[P,E]=(0,a.useState)(""),[Z,T]=(0,a.useState)({count:0,date:""});(0,a.useEffect)(()=>{M()},[]),(0,a.useEffect)(()=>{t&&C()},[t]);let M=async()=>{try{let t=(0,n.J)(),{data:{session:s},error:a}=await t.auth.getSession();if(a||!s){console.log("❌ No active session, redirecting to login"),e.push("/login");return}r(s.user)}catch(t){console.error("Error loading user data:",t),e.push("/login")}finally{b(!1)}},C=()=>{let e=new Date().toLocaleDateString(),t=localStorage.getItem("fortune-usage");if(t){let r=JSON.parse(t);if(r.date===e)T(r);else{let t={count:0,date:e};localStorage.setItem("fortune-usage",JSON.stringify(t)),T(t)}}else{let t={count:0,date:e};localStorage.setItem("fortune-usage",JSON.stringify(t)),T(t)}},F=()=>{let e={count:Z.count+1,date:Z.date};localStorage.setItem("fortune-usage",JSON.stringify(e)),T(e)},q=Z.count<2,O=async e=>{if(e.preventDefault(),!q){E("You have reached your daily limit of 2 fortune readings. Please try again tomorrow.");return}if(!(null==t?void 0:t.id)){E("You must be logged in to use fortune telling.");return}v(!0),E("");try{let e=await _.post("/fortune/tell-fortune",{userId:t.id,birthDate:w.birthDate,birthTime:w.birthTime,birthPlace:w.birthPlace});e.success?(k(e.fortune),F()):E(e.error||"Failed to generate fortune reading")}catch(e){E(e.message||"An error occurred while generating your fortune")}finally{v(!1)}},A=(e,t)=>{j(r=>({...r,[e]:t}))};return x?(0,s.jsx)(i.Z,{children:(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-yellow-400 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-yellow-200",children:"Loading fortune teller..."})]})})}):(0,s.jsx)(i.Z,{children:(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-red-900 via-red-800 to-yellow-900 relative overflow-hidden",children:[(0,s.jsxs)("div",{className:"absolute inset-0 opacity-10",children:[(0,s.jsx)("div",{className:"absolute top-10 left-10 w-32 h-32 rounded-full bg-yellow-400 animate-pulse"}),(0,s.jsx)("div",{className:"absolute top-40 right-20 w-24 h-24 rounded-full bg-red-400 animate-pulse delay-1000"}),(0,s.jsx)("div",{className:"absolute bottom-20 left-1/4 w-20 h-20 rounded-full bg-yellow-300 animate-pulse delay-2000"}),(0,s.jsx)("div",{className:"absolute bottom-40 right-1/3 w-28 h-28 rounded-full bg-red-300 animate-pulse delay-3000"})]}),(0,s.jsx)("div",{className:"absolute top-20 right-10 text-yellow-400 opacity-20 animate-bounce",children:(0,s.jsx)(h.Z,{className:"h-16 w-16"})}),(0,s.jsx)("div",{className:"absolute bottom-32 left-16 text-red-400 opacity-20 animate-bounce delay-2000",children:(0,s.jsx)(m.Z,{className:"h-12 w-12"})}),(0,s.jsxs)("div",{className:"max-w-6xl mx-auto py-8 px-4 relative z-10",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsxs)("h1",{className:"text-4xl md:text-5xl font-bold text-yellow-300 mb-4 font-serif tracking-wide",children:[(0,s.jsx)(m.Z,{className:"inline h-8 w-8 md:h-10 md:w-10 mr-3 text-yellow-400"}),"东方占卜",(0,s.jsx)(m.Z,{className:"inline h-8 w-8 md:h-10 md:w-10 ml-3 text-yellow-400"})]}),(0,s.jsx)("h2",{className:"text-2xl md:text-3xl font-semibold text-red-200 mb-2 font-serif",children:"Oriental Fortune Telling"}),(0,s.jsx)("p",{className:"text-yellow-200 text-lg max-w-2xl mx-auto leading-relaxed",children:"Unlock the mysteries of your destiny through ancient Eastern wisdom. Discover your path through the harmony of time, place, and cosmic energy."}),(0,s.jsxs)("div",{className:"mt-4 inline-flex items-center gap-2 bg-red-800/50 px-4 py-2 rounded-full border border-yellow-400/30",children:[(0,s.jsx)(y,{className:"h-4 w-4 text-yellow-400"}),(0,s.jsxs)("span",{className:"text-yellow-200 text-sm",children:["Daily Readings: ",Z.count,"/2"]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[!D&&(0,s.jsxs)(u.Zb,{className:"bg-gradient-to-br from-red-800/80 to-yellow-800/60 border-2 border-yellow-500/50 shadow-2xl backdrop-blur-sm",children:[(0,s.jsxs)(u.Ol,{className:"text-center",children:[(0,s.jsxs)(u.ll,{className:"text-2xl text-yellow-300 font-serif flex items-center justify-center gap-3",children:[(0,s.jsx)(f.Z,{className:"h-6 w-6"}),"Your Birth Details"]}),(0,s.jsx)(u.SZ,{className:"text-red-200",children:"Enter your birth information to reveal your cosmic blueprint"})]}),(0,s.jsx)(u.aY,{className:"space-y-6",children:(0,s.jsxs)("form",{onSubmit:O,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(d._,{htmlFor:"birthDate",className:"text-yellow-300 font-medium flex items-center gap-2",children:[(0,s.jsx)(f.Z,{className:"h-4 w-4"}),"Date of Birth"]}),(0,s.jsx)(c.I,{id:"birthDate",type:"date",value:w.birthDate,onChange:e=>A("birthDate",e.target.value),required:!0,className:"bg-red-900/50 border-yellow-500/50 text-yellow-200 focus:border-yellow-400 focus:ring-yellow-400/50"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(d._,{htmlFor:"birthTime",className:"text-yellow-300 font-medium flex items-center gap-2",children:[(0,s.jsx)(g.Z,{className:"h-4 w-4"}),"Time of Birth"]}),(0,s.jsx)(c.I,{id:"birthTime",type:"time",value:w.birthTime,onChange:e=>A("birthTime",e.target.value),required:!0,className:"bg-red-900/50 border-yellow-500/50 text-yellow-200 focus:border-yellow-400 focus:ring-yellow-400/50"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(d._,{htmlFor:"birthPlace",className:"text-yellow-300 font-medium flex items-center gap-2",children:[(0,s.jsx)(p,{className:"h-4 w-4"}),"Place of Birth"]}),(0,s.jsx)(c.I,{id:"birthPlace",type:"text",placeholder:"City, Country (e.g., Kuala Lumpur, Malaysia)",value:w.birthPlace,onChange:e=>A("birthPlace",e.target.value),required:!0,className:"bg-red-900/50 border-yellow-500/50 text-yellow-200 focus:border-yellow-400 focus:ring-yellow-400/50 placeholder:text-red-300"})]}),P&&(0,s.jsx)("div",{className:"bg-red-900/70 border border-red-500 p-3 rounded-lg",children:(0,s.jsx)("p",{className:"text-red-200 text-sm",children:P})}),(0,s.jsx)(o.z,{type:"submit",disabled:N||!q,className:"w-full bg-gradient-to-r from-yellow-500 to-red-500 hover:from-yellow-400 hover:to-red-400 text-red-900 font-bold py-3 text-lg disabled:opacity-50 disabled:cursor-not-allowed border border-yellow-400 shadow-lg hover:shadow-xl transition-all duration-300",children:N?(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,s.jsx)("div",{className:"w-5 h-5 border-2 border-red-900 border-t-transparent rounded-full animate-spin"}),"Consulting the Oracle..."]}):q?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.Z,{className:"h-5 w-5 mr-2"}),"Reveal My Fortune"]}):"Daily Limit Reached"})]})})]}),!D&&!N&&(0,s.jsxs)(u.Zb,{className:"bg-gradient-to-br from-yellow-800/60 to-red-800/80 border-2 border-red-500/50 shadow-2xl backdrop-blur-sm",children:[(0,s.jsx)(u.Ol,{className:"text-center",children:(0,s.jsxs)(u.ll,{className:"text-2xl text-red-200 font-serif flex items-center justify-center gap-3",children:[(0,s.jsx)(h.Z,{className:"h-6 w-6 text-yellow-400"}),"Ancient Wisdom Awaits"]})}),(0,s.jsx)(u.aY,{children:(0,s.jsxs)("div",{className:"text-center py-6",children:[(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)("div",{className:"w-24 h-24 mx-auto bg-gradient-to-br from-yellow-400 to-red-500 rounded-full flex items-center justify-center animate-pulse",children:(0,s.jsx)(m.Z,{className:"h-12 w-12 text-red-900"})})}),(0,s.jsx)("p",{className:"text-yellow-200 mb-6 leading-relaxed",children:"The cosmic energies are aligned and ready to reveal your destiny. Provide your birth details to unlock the secrets written in the stars."}),(0,s.jsxs)("div",{className:"bg-red-900/50 p-4 rounded-lg border border-yellow-500/30",children:[(0,s.jsx)("p",{className:"text-yellow-300 text-sm mb-2 font-semibold",children:"✨ Your Reading Will Include:"}),(0,s.jsxs)("ul",{className:"text-red-200 text-sm space-y-1 text-left",children:[(0,s.jsx)("li",{children:"• Personality & Core Traits Analysis"}),(0,s.jsx)("li",{children:"• Career Path Guidance"}),(0,s.jsx)("li",{children:"• Wealth & Financial Outlook"}),(0,s.jsx)("li",{children:"• Relationships & Family Destiny"}),(0,s.jsx)("li",{children:"• Health Tendencies & Warnings"}),(0,s.jsx)("li",{children:"• Key Life Periods & Turning Points"}),(0,s.jsx)("li",{children:"• Practical Wisdom for Your Journey"})]})]})]})})]}),D&&(0,s.jsx)("div",{className:"lg:col-span-2",children:(0,s.jsx)(S,{fortune:D,onTryAgain:()=>{k(null),E("")},canTryAgain:q})})]})]})]})})}function S(e){let{fortune:t,onTryAgain:r,canTryAgain:a}=e,l=[{key:"personality",title:"性格 Personality & Core Traits",icon:y,content:t.personality},{key:"career",title:"事业 Career Path",icon:h.Z,content:t.career},{key:"wealth",title:"财富 Wealth & Financial Outlook",icon:m.Z,content:t.wealth},{key:"relationships",title:"关系 Relationships & Family",icon:y,content:t.relationships},{key:"health",title:"健康 Health Tendencies",icon:h.Z,content:t.health},{key:"lifePeriods",title:"转机 Key Life Periods",icon:m.Z,content:t.lifePeriods},{key:"advice",title:"忠告 Practical Advice",icon:y,content:t.advice}];return(0,s.jsxs)(u.Zb,{className:"bg-gradient-to-br from-yellow-50 to-red-50 border-4 border-red-600 shadow-2xl backdrop-blur-sm relative overflow-hidden",children:[(0,s.jsx)("div",{className:"absolute top-0 left-0 w-full h-8 bg-gradient-to-r from-red-600 via-yellow-500 to-red-600"}),(0,s.jsx)("div",{className:"absolute bottom-0 left-0 w-full h-8 bg-gradient-to-r from-red-600 via-yellow-500 to-red-600"}),(0,s.jsxs)(u.Ol,{className:"text-center pt-12 pb-6 bg-gradient-to-br from-red-800/10 to-yellow-600/20",children:[(0,s.jsx)(u.ll,{className:"text-3xl md:text-4xl text-red-800 font-serif mb-2",children:"Your Celestial Scroll"}),(0,s.jsx)(u.SZ,{className:"text-red-600 text-lg",children:"The cosmos has spoken - here is your divine reading"})]}),(0,s.jsxs)(u.aY,{className:"p-6 md:p-8 space-y-8",children:[l.map((e,t)=>{if(!e.content)return null;let r=e.icon;return(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,s.jsx)("div",{className:"bg-gradient-to-r from-red-600 to-yellow-500 p-2 rounded-full",children:(0,s.jsx)(r,{className:"h-5 w-5 text-white"})}),(0,s.jsx)("h3",{className:"text-xl font-serif font-bold text-red-800",children:e.title})]}),(0,s.jsx)("div",{className:"bg-gradient-to-br from-yellow-50/50 to-red-50/30 p-4 md:p-6 rounded-lg border-l-4 border-red-500 shadow-inner",children:(0,s.jsx)("p",{className:"text-red-900 leading-relaxed whitespace-pre-wrap",children:e.content})}),t<l.filter(e=>e.content).length-1&&(0,s.jsx)("div",{className:"flex justify-center my-6",children:(0,s.jsx)("div",{className:"w-16 h-1 bg-gradient-to-r from-transparent via-red-400 to-transparent"})})]},e.key)}),(0,s.jsx)("div",{className:"text-center pt-6 border-t-2 border-red-300",children:(0,s.jsx)(o.z,{onClick:r,disabled:!a,className:"bg-gradient-to-r from-red-600 to-yellow-500 hover:from-red-500 hover:to-yellow-400 text-white font-bold px-8 py-3 disabled:opacity-50 disabled:cursor-not-allowed border border-red-400 shadow-lg hover:shadow-xl transition-all duration-300",children:a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.Z,{className:"h-4 w-4 mr-2"}),"Seek Another Reading"]}):"Daily Limit Reached"})})]})]})}},26815:function(e,t,r){"use strict";r.d(t,{_:function(){return n}});var s=r(57437),a=r(2265),l=r(94508);let n=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("label",{ref:t,className:(0,l.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",r),...a})});n.displayName="Label"},88685:function(e,t,r){"use strict";r.d(t,{ZE:function(){return l},aA:function(){return a},bK:function(){return o},fB:function(){return i},gK:function(){return n},ns:function(){return s}});let s={groceries:"\uD83D\uDED2",dining:"\uD83C\uDF7D️",gas:"⛽",pharmacy:"\uD83D\uDC8A",retail:"\uD83D\uDECD️",services:"\uD83D\uDD27",entertainment:"\uD83C\uDFAC",other:"\uD83D\uDCE6"},a=["all","groceries","dining","gas","pharmacy","retail","services","entertainment","other"],l=["#8884d8","#82ca9d","#ffc658","#ff7300","#00c49f","#0088fe","#ff0062"],n=20,i="Asia/Kuala_Lumpur",o=e=>s[e]||s.other},89912:function(e,t,r){"use strict";r.d(t,{AP:function(){return u},Gv:function(){return h},S8:function(){return g},T5:function(){return x},TS:function(){return m},U_:function(){return d},YM:function(){return y},Y_:function(){return c},ln:function(){return f}});var s=r(646),a=r(56739),l=r(10496),n=r(74968),i=r(95348),o=r(88685);let c=e=>{let t=new Date;switch(e){case"week":return{start:(0,s.z)(t),end:t};case"month":return{start:(0,a.N)(t),end:t};default:return null}},d=e=>(0,i.CV)(new Date(e),o.fB,"MMM dd, yyyy"),u=e=>(0,i.CV)(new Date(e),o.fB,"MMM dd, h:mm a"),h=e=>(0,l.WU)(e,"yyyy-MM-dd"),m=()=>(0,l.WU)(new Date,"yyyy-MM-dd"),x=()=>{let e=(0,n.k)(new Date,1);return(0,l.WU)(e,"yyyy-MM-dd")},y=e=>{let t=(0,n.k)(new Date,e);return(0,l.WU)(t,"yyyy-MM-dd")},f=()=>(0,l.WU)((0,s.z)(new Date),"yyyy-MM-dd"),g=()=>(0,l.WU)((0,a.N)(new Date),"yyyy-MM-dd")},91723:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(39763).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},11239:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(39763).Z)("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]])}},function(e){e.O(0,[284,609,452,963,780,287,429,162,971,117,744],function(){return e(e.s=41418)}),_N_E=e.O()}]);