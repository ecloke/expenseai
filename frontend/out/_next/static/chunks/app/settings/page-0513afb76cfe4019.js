(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[938],{92955:function(e,t,s){Promise.resolve().then(s.bind(s,37871))},37871:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return _}});var r=s(57437),a=s(2265),l=s(99376),n=s(4125),i=s(2141),o=s(66070),c=s(62869),d=s(95186),u=s(26815),m=s(35974),x=s(65613),g=s(22252),h=s(65302),y=s(39763);let f=(0,y.Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var b=s(82222),p=s(96362),v=s(87769),j=s(42208),N=s(64972);let w=(0,y.Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);function _(){let[e,t]=(0,a.useState)(null),[s,y]=(0,a.useState)(null),[_,k]=(0,a.useState)(null),[Z,S]=(0,a.useState)(!0),[C,A]=(0,a.useState)(!1),[z,I]=(0,a.useState)(!1),[T,E]=(0,a.useState)(!1),[O,G]=(0,a.useState)(null),[M,B]=(0,a.useState)(null),[F,P]=(0,a.useState)(""),[R,q]=(0,a.useState)(""),[U,Y]=(0,a.useState)(""),J=(0,l.useRouter)();(0,a.useEffect)(()=>{V()},[]);let V=async()=>{try{let e=(0,i.J)(),{data:{session:s},error:r}=await e.auth.getSession();if(r||!s){J.push("/login");return}k(s.user);let{data:a,error:l}=await e.from("user_configs").select("*").eq("user_id",s.user.id).single();if(l&&"PGRST116"!==l.code)throw l;if(a&&(t(a),P(a.telegram_bot_token||""),q(a.telegram_bot_username||""),Y(a.gemini_api_key||""),a.telegram_bot_username)){let{data:t}=await e.from("bot_sessions").select("*").eq("user_id",s.user.id).single();y(t)}}catch(e){console.error("Error loading user data:",e),G("Failed to load settings")}finally{S(!1)}},D=async()=>{if(_)try{A(!0),G(null),B(null);let e=(0,i.J)(),t={user_id:_.id,telegram_bot_token:F.trim()||null,telegram_bot_username:R.trim()||null,gemini_api_key:U.trim()||null,updated_at:new Date().toISOString()},{error:s}=await e.from("user_configs").upsert(t,{onConflict:"user_id"});if(s)throw s;B("Settings saved successfully!"),setTimeout(()=>{V()},1e3)}catch(e){console.error("Error saving settings:",e),G("Failed to save settings. Please try again.")}finally{A(!1)}},H=async()=>{if(!F.trim()||!R.trim()){G("Please enter both Telegram bot token and username first");return}try{A(!0),G(null);let e=await fetch("".concat("https://expenseai-production.up.railway.app","/api/bot/test"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:F.trim(),username:R.trim()})});if(!e.ok)throw Error("Failed to test bot connection");let t=await e.json();t.success?B("Bot connection successful!"):G(t.error||"Bot connection failed")}catch(e){console.error("Error testing bot:",e),G("Failed to test bot connection")}finally{A(!1)}};return Z?(0,r.jsx)(n.Z,{children:(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-400 mx-auto mb-4"}),(0,r.jsx)("div",{className:"text-gray-300",children:"Loading settings..."})]})}):(0,r.jsx)(n.Z,{children:(0,r.jsxs)("div",{className:"space-y-6 max-w-4xl",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-white",children:"Settings"}),(0,r.jsx)("p",{className:"text-gray-400 mt-2",children:"Configure your Telegram bot and AI settings"})]}),O&&(0,r.jsxs)(x.bZ,{className:"border-red-600 bg-red-900/20",children:[(0,r.jsx)(g.Z,{className:"h-4 w-4 text-red-400"}),(0,r.jsx)(x.X,{className:"text-red-300",children:O})]}),M&&(0,r.jsxs)(x.bZ,{className:"border-green-600 bg-green-900/20",children:[(0,r.jsx)(h.Z,{className:"h-4 w-4 text-green-400"}),(0,r.jsx)(x.X,{className:"text-green-300",children:M})]}),(0,r.jsxs)(o.Zb,{className:"bg-gray-800 border-gray-700",children:[(0,r.jsx)(o.Ol,{children:(0,r.jsxs)(o.ll,{className:"flex items-center gap-2 text-white",children:[(0,r.jsx)(f,{className:"h-5 w-5 text-blue-400"}),"Account Information"]})}),(0,r.jsx)(o.aY,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(u._,{className:"text-gray-300",children:"Email"}),(0,r.jsx)("div",{className:"text-white bg-gray-700/50 p-3 rounded-md border border-gray-600",children:null==_?void 0:_.email})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(u._,{className:"text-gray-300",children:"User ID"}),(0,r.jsx)("div",{className:"text-gray-400 bg-gray-700/50 p-3 rounded-md border border-gray-600 font-mono text-sm",children:null==_?void 0:_.id})]})]})})]}),(0,r.jsxs)(o.Zb,{className:"bg-gray-800 border-gray-700",children:[(0,r.jsxs)(o.Ol,{children:[(0,r.jsxs)(o.ll,{className:"flex items-center gap-2 text-white",children:[(0,r.jsx)(b.Z,{className:"h-5 w-5 text-blue-400"}),"Telegram Bot Configuration"]}),(0,r.jsx)(o.SZ,{className:"text-gray-400",children:"Configure your Telegram bot for receipt processing"})]}),(0,r.jsxs)(o.aY,{className:"space-y-6",children:[(null==e?void 0:e.telegram_bot_username)&&(0,r.jsx)("div",{className:"p-4 rounded-lg bg-gray-700/50 border border-gray-600",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(null==s?void 0:s.is_active)?(0,r.jsx)(h.Z,{className:"h-5 w-5 text-green-400"}):(0,r.jsx)(g.Z,{className:"h-5 w-5 text-yellow-400"}),(0,r.jsxs)("span",{className:"font-medium text-gray-200",children:["@",e.telegram_bot_username]})]}),(0,r.jsx)(m.C,{variant:(null==s?void 0:s.is_active)?"default":"secondary",className:(null==s?void 0:s.is_active)?"bg-green-600 hover:bg-green-700":"bg-gray-600",children:(null==s?void 0:s.is_active)?"Online":"Offline"})]}),(0,r.jsx)(c.z,{variant:"outline",size:"sm",className:"border-gray-600 text-gray-300 hover:bg-gray-700 hover:text-white hover:border-gray-500",asChild:!0,children:(0,r.jsxs)("a",{href:"https://t.me/".concat(e.telegram_bot_username),target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2",children:[(0,r.jsx)(p.Z,{className:"h-4 w-4"}),"Open Bot"]})})]})}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(u._,{htmlFor:"telegram-token",className:"text-gray-300",children:"Bot Token"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(d.I,{id:"telegram-token",type:z?"text":"password",placeholder:"123456789:ABCdefGhIJKlmNoPQRsTUVwxyz",value:F,onChange:e=>P(e.target.value),className:"bg-gray-700 border-gray-600 text-white placeholder:text-gray-400 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 focus:ring-opacity-20 pr-10"}),(0,r.jsx)(c.z,{type:"button",variant:"ghost",size:"sm",className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white h-6 w-6 p-0",onClick:()=>I(!z),children:z?(0,r.jsx)(v.Z,{className:"h-4 w-4"}):(0,r.jsx)(j.Z,{className:"h-4 w-4"})})]}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Get your bot token from @BotFather on Telegram"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(u._,{htmlFor:"telegram-username",className:"text-gray-300",children:"Bot Username"}),(0,r.jsx)(d.I,{id:"telegram-username",type:"text",placeholder:"your_bot_name",value:R,onChange:e=>q(e.target.value),className:"bg-gray-700 border-gray-600 text-white placeholder:text-gray-400 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 focus:ring-opacity-20"}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Your bot's username (without @)"})]}),(0,r.jsx)(c.z,{onClick:H,disabled:C||!F.trim()||!R.trim(),variant:"outline",className:"border-blue-600 text-blue-400 hover:bg-blue-600 hover:text-white",children:C?"Testing...":"Test Connection"})]})]}),(0,r.jsxs)(o.Zb,{className:"bg-gray-800 border-gray-700",children:[(0,r.jsxs)(o.Ol,{children:[(0,r.jsxs)(o.ll,{className:"flex items-center gap-2 text-white",children:[(0,r.jsx)(N.Z,{className:"h-5 w-5 text-purple-400"}),"Gemini AI Configuration"]}),(0,r.jsx)(o.SZ,{className:"text-gray-400",children:"Configure Google Gemini AI for receipt text extraction"})]}),(0,r.jsx)(o.aY,{className:"space-y-6",children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(u._,{htmlFor:"gemini-key",className:"text-gray-300",children:"Gemini API Key"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(d.I,{id:"gemini-key",type:T?"text":"password",placeholder:"AIzaSyAbCdEfGhIjKlMnOpQrStUvWxYz123456789",value:U,onChange:e=>Y(e.target.value),className:"bg-gray-700 border-gray-600 text-white placeholder:text-gray-400 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 focus:ring-opacity-20 pr-10"}),(0,r.jsx)(c.z,{type:"button",variant:"ghost",size:"sm",className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white h-6 w-6 p-0",onClick:()=>E(!T),children:T?(0,r.jsx)(v.Z,{className:"h-4 w-4"}):(0,r.jsx)(j.Z,{className:"h-4 w-4"})})]}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Get your API key from Google AI Studio"})]})})]}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsxs)(c.z,{onClick:D,disabled:C,className:"bg-blue-600 hover:bg-blue-700 text-white",children:[(0,r.jsx)(w,{className:"h-4 w-4 mr-2"}),C?"Saving...":"Save Settings"]})})]})})}},65613:function(e,t,s){"use strict";s.d(t,{X:function(){return c},bZ:function(){return o}});var r=s(57437),a=s(2265),l=s(90535),n=s(94508);let i=(0,l.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),o=a.forwardRef((e,t)=>{let{className:s,variant:a,...l}=e;return(0,r.jsx)("div",{ref:t,role:"alert",className:(0,n.cn)(i({variant:a}),s),...l})});o.displayName="Alert",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("h5",{ref:t,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",s),...a})}).displayName="AlertTitle";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",s),...a})});c.displayName="AlertDescription"},26815:function(e,t,s){"use strict";s.d(t,{_:function(){return n}});var r=s(57437),a=s(2265),l=s(94508);let n=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("label",{ref:t,className:(0,l.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",s),...a})});n.displayName="Label"},64972:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(39763).Z)("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]])},96362:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(39763).Z)("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]])},87769:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(39763).Z)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]])},42208:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(39763).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])}},function(e){e.O(0,[284,452,963,780,109,162,971,117,744],function(){return e(e.s=92955)}),_N_E=e.O()}]);