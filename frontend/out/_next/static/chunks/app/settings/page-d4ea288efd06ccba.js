(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[938],{92955:function(e,t,a){Promise.resolve().then(a.bind(a,37871))},37871:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return w}});var r=a(57437),s=a(2265),l=a(99376),n=a(4125),i=a(2141),c=a(66070),o=a(62869),d=a(95186),u=a(26815),h=a(35974),x=a(65613),g=a(22252),m=a(65302),y=a(39763);let f=(0,y.Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var p=a(82222),b=a(96362),v=a(87769),j=a(42208),N=a(64972);let k=(0,y.Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);function w(){let[e,t]=(0,s.useState)(null),[a,y]=(0,s.useState)(null),[w,_]=(0,s.useState)(null),[Z,S]=(0,s.useState)(!0),[C,z]=(0,s.useState)(!1),[A,M]=(0,s.useState)(!1),[I,O]=(0,s.useState)(!1),[T,E]=(0,s.useState)(null),[q,B]=(0,s.useState)(null),[G,V]=(0,s.useState)(""),[F,P]=(0,s.useState)(""),[R,L]=(0,s.useState)(""),H=(0,l.useRouter)();(0,s.useEffect)(()=>{U()},[]);let U=async()=>{try{let e=(0,i.J)(),{data:{session:a},error:r}=await e.auth.getSession();if(r||!a){H.push("/login");return}_(a.user);let{data:s,error:l}=await e.from("user_configs").select("*").eq("user_id",a.user.id).single();if(l&&"PGRST116"!==l.code)throw l;if(s&&(t(s),V(s.telegram_bot_token||""),P(s.telegram_bot_username||""),L(s.gemini_api_key||""),s.telegram_bot_username)){let{data:t}=await e.from("bot_sessions").select("*").eq("user_id",a.user.id).single();y(t)}}catch(e){console.error("Error loading user data:",e),E("Failed to load settings")}finally{S(!1)}},Y=async()=>{if(w)try{z(!0),E(null),B(null);let e=(0,i.J)(),t={user_id:w.id,telegram_bot_token:G.trim()||null,telegram_bot_username:F.trim()||null,gemini_api_key:R.trim()||null,updated_at:new Date().toISOString()},{error:a}=await e.from("user_configs").upsert(t,{onConflict:"user_id"});if(a)throw a;B("Settings saved successfully!"),setTimeout(()=>{U()},1e3)}catch(e){console.error("Error saving settings:",e),E("Failed to save settings. Please try again.")}finally{z(!1)}},D=async()=>{if(!G.trim()||!F.trim()){E("Please enter both Telegram bot token and username first");return}try{z(!0),E(null);let e=await fetch("".concat("https://expenseai-production.up.railway.app","/api/bot/test"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:G.trim(),username:F.trim()})});if(!e.ok)throw Error("Failed to test bot connection");let t=await e.json();t.success?B("Bot connection successful!"):E(t.error||"Bot connection failed")}catch(e){console.error("Error testing bot:",e),E("Failed to test bot connection")}finally{z(!1)}};return Z?(0,r.jsx)(n.Z,{children:(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-400 mx-auto mb-4"}),(0,r.jsx)("div",{className:"text-gray-300",children:"Loading settings..."})]})}):(0,r.jsx)(n.Z,{children:(0,r.jsxs)("div",{className:"space-y-6 max-w-4xl",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-white",children:"Settings"}),(0,r.jsx)("p",{className:"text-gray-400 mt-2",children:"Configure your Telegram bot and AI settings"})]}),T&&(0,r.jsxs)(x.bZ,{className:"border-red-600 bg-red-900/20",children:[(0,r.jsx)(g.Z,{className:"h-4 w-4 text-red-400"}),(0,r.jsx)(x.X,{className:"text-red-300",children:T})]}),q&&(0,r.jsxs)(x.bZ,{className:"border-green-600 bg-green-900/20",children:[(0,r.jsx)(m.Z,{className:"h-4 w-4 text-green-400"}),(0,r.jsx)(x.X,{className:"text-green-300",children:q})]}),(0,r.jsxs)(c.Zb,{className:"bg-gray-800 border-gray-700",children:[(0,r.jsx)(c.Ol,{children:(0,r.jsxs)(c.ll,{className:"flex items-center gap-2 text-white",children:[(0,r.jsx)(f,{className:"h-5 w-5 text-blue-400"}),"Account Information"]})}),(0,r.jsx)(c.aY,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(u._,{className:"text-gray-300",children:"Email"}),(0,r.jsx)("div",{className:"text-white bg-gray-700/50 p-3 rounded-md border border-gray-600",children:null==w?void 0:w.email})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(u._,{className:"text-gray-300",children:"User ID"}),(0,r.jsx)("div",{className:"text-gray-400 bg-gray-700/50 p-3 rounded-md border border-gray-600 font-mono text-sm",children:null==w?void 0:w.id})]})]})})]}),(0,r.jsxs)(c.Zb,{className:"bg-gray-800 border-gray-700",children:[(0,r.jsxs)(c.Ol,{children:[(0,r.jsxs)(c.ll,{className:"flex items-center gap-2 text-white",children:[(0,r.jsx)(p.Z,{className:"h-5 w-5 text-blue-400"}),"Telegram Bot Configuration"]}),(0,r.jsx)(c.SZ,{className:"text-gray-400",children:"Configure your Telegram bot for receipt processing"})]}),(0,r.jsxs)(c.aY,{className:"space-y-6",children:[(null==e?void 0:e.telegram_bot_username)&&(0,r.jsx)("div",{className:"p-4 rounded-lg bg-gray-700/50 border border-gray-600",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(null==a?void 0:a.is_active)?(0,r.jsx)(m.Z,{className:"h-5 w-5 text-green-400"}):(0,r.jsx)(g.Z,{className:"h-5 w-5 text-yellow-400"}),(0,r.jsxs)("span",{className:"font-medium text-gray-200",children:["@",e.telegram_bot_username]})]}),(0,r.jsx)(h.C,{variant:(null==a?void 0:a.is_active)?"default":"secondary",className:(null==a?void 0:a.is_active)?"bg-green-600 hover:bg-green-700":"bg-gray-600",children:(null==a?void 0:a.is_active)?"Online":"Offline"})]}),(0,r.jsx)(o.z,{variant:"outline",size:"sm",className:"border-gray-600 text-gray-300 hover:bg-gray-700 hover:text-white hover:border-gray-500",asChild:!0,children:(0,r.jsxs)("a",{href:"https://t.me/".concat(e.telegram_bot_username),target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2",children:[(0,r.jsx)(b.Z,{className:"h-4 w-4"}),"Open Bot"]})})]})}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(u._,{htmlFor:"telegram-token",className:"text-gray-300",children:"Bot Token"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(d.I,{id:"telegram-token",type:A?"text":"password",placeholder:"123456789:ABCdefGhIJKlmNoPQRsTUVwxyz",value:G,onChange:e=>V(e.target.value),className:"bg-gray-700 border-gray-600 text-white placeholder:text-gray-400 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 focus:ring-opacity-20 pr-10"}),(0,r.jsx)(o.z,{type:"button",variant:"ghost",size:"sm",className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white h-6 w-6 p-0",onClick:()=>M(!A),children:A?(0,r.jsx)(v.Z,{className:"h-4 w-4"}):(0,r.jsx)(j.Z,{className:"h-4 w-4"})})]}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Get your bot token from @BotFather on Telegram"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(u._,{htmlFor:"telegram-username",className:"text-gray-300",children:"Bot Username"}),(0,r.jsx)(d.I,{id:"telegram-username",type:"text",placeholder:"your_bot_name",value:F,onChange:e=>P(e.target.value),className:"bg-gray-700 border-gray-600 text-white placeholder:text-gray-400 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 focus:ring-opacity-20"}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Your bot's username (without @)"})]}),(0,r.jsx)(o.z,{onClick:D,disabled:C||!G.trim()||!F.trim(),variant:"outline",className:"border-blue-600 text-blue-400 hover:bg-blue-600 hover:text-white",children:C?"Testing...":"Test Connection"})]})]}),(0,r.jsxs)(c.Zb,{className:"bg-gray-800 border-gray-700",children:[(0,r.jsxs)(c.Ol,{children:[(0,r.jsxs)(c.ll,{className:"flex items-center gap-2 text-white",children:[(0,r.jsx)(N.Z,{className:"h-5 w-5 text-purple-400"}),"Gemini AI Configuration"]}),(0,r.jsx)(c.SZ,{className:"text-gray-400",children:"Configure Google Gemini AI for receipt text extraction"})]}),(0,r.jsx)(c.aY,{className:"space-y-6",children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(u._,{htmlFor:"gemini-key",className:"text-gray-300",children:"Gemini API Key"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(d.I,{id:"gemini-key",type:I?"text":"password",placeholder:"AIzaSyAbCdEfGhIjKlMnOpQrStUvWxYz123456789",value:R,onChange:e=>L(e.target.value),className:"bg-gray-700 border-gray-600 text-white placeholder:text-gray-400 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 focus:ring-opacity-20 pr-10"}),(0,r.jsx)(o.z,{type:"button",variant:"ghost",size:"sm",className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white h-6 w-6 p-0",onClick:()=>O(!I),children:I?(0,r.jsx)(v.Z,{className:"h-4 w-4"}):(0,r.jsx)(j.Z,{className:"h-4 w-4"})})]}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Get your API key from Google AI Studio"})]})})]}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsxs)(o.z,{onClick:Y,disabled:C,className:"bg-blue-600 hover:bg-blue-700 text-white",children:[(0,r.jsx)(k,{className:"h-4 w-4 mr-2"}),C?"Saving...":"Save Settings"]})})]})})}},65613:function(e,t,a){"use strict";a.d(t,{X:function(){return o},bZ:function(){return c}});var r=a(57437),s=a(2265),l=a(90535),n=a(94508);let i=(0,l.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),c=s.forwardRef((e,t)=>{let{className:a,variant:s,...l}=e;return(0,r.jsx)("div",{ref:t,role:"alert",className:(0,n.cn)(i({variant:s}),a),...l})});c.displayName="Alert",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("h5",{ref:t,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",a),...s})}).displayName="AlertTitle";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",a),...s})});o.displayName="AlertDescription"},26815:function(e,t,a){"use strict";a.d(t,{_:function(){return n}});var r=a(57437),s=a(2265),l=a(94508);let n=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("label",{ref:t,className:(0,l.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",a),...s})});n.displayName="Label"},22252:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(39763).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},82222:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(39763).Z)("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]])},64972:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(39763).Z)("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]])},65302:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(39763).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},96362:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(39763).Z)("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]])},87769:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(39763).Z)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]])},42208:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(39763).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},25466:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(39763).Z)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]])},47692:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(39763).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},98728:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(39763).Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])}},function(e){e.O(0,[284,452,963,804,971,117,744],function(){return e(e.s=92955)}),_N_E=e.O()}]);