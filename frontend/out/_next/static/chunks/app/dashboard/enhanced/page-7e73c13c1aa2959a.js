(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[44],{69133:function(e,s,r){Promise.resolve().then(r.bind(r,51284))},51284:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return k}});var t=r(57437),n=r(2265),a=r(99376),i=r(27648),l=r(2141),d=r(66070),o=r(35974),c=r(62869),u=r(65613),f=r(12339),m=r(46949),x=r(18990),h=r(22252),g=r(47692),p=r(46221),b=r(98728),v=r(82222),j=r(65302),y=r(96362),N=r(11239),w=r(48664),Z=r(71621);function k(){let[e,s]=(0,n.useState)(!0),[r,k]=(0,n.useState)(null),[C,_]=(0,n.useState)(null),[I,S]=(0,n.useState)(null),R=(0,a.useRouter)();(0,n.useEffect)(()=>{z()},[]);let z=async()=>{try{let e=(0,l.J)(),{data:{session:s},error:r}=await e.auth.getSession();if(r||!s){console.log("âŒ No active session, redirecting to login"),R.push("/login");return}S(s.user);let{data:t,error:n}=await e.from("user_configs").select("*").eq("user_id",s.user.id).single();if(n&&"PGRST116"!==n.code)throw n;if(k(t),null==t?void 0:t.telegram_bot_username){let{data:r}=await e.from("bot_sessions").select("*").eq("user_id",s.user.id).single();_(r)}}catch(e){console.error("Error loading user data:",e)}finally{s(!1)}},O=async()=>{let e=(0,l.J)();await e.auth.signOut(),R.push("/login")};return e?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,t.jsx)("p",{children:"Loading dashboard..."})]})}):r&&r.telegram_bot_token&&r.gemini_api_key?(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-white",children:(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Expense Dashboard"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Track and analyze your spending patterns"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(c.z,{variant:"outline",asChild:!0,children:(0,t.jsxs)(i.default,{href:"/dashboard",children:[(0,t.jsx)(p.Z,{className:"h-4 w-4 mr-2"}),"Classic View"]})}),(0,t.jsx)(c.z,{variant:"outline",asChild:!0,children:(0,t.jsxs)(i.default,{href:"/setup",children:[(0,t.jsx)(b.Z,{className:"h-4 w-4 mr-2"}),"Settings"]})}),(0,t.jsxs)(c.z,{variant:"outline",onClick:O,children:[(0,t.jsx)(g.Z,{className:"h-4 w-4 mr-2"}),"Sign Out"]})]})]}),(0,t.jsxs)(d.Zb,{className:"mb-8",children:[(0,t.jsx)(d.Ol,{children:(0,t.jsxs)(d.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(v.Z,{className:"h-5 w-5"}),"Bot Status"]})}),(0,t.jsx)(d.aY,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(null==C?void 0:C.is_active)?(0,t.jsx)(j.Z,{className:"h-5 w-5 text-green-600"}):(0,t.jsx)(h.Z,{className:"h-5 w-5 text-orange-600"}),(0,t.jsxs)("span",{className:"font-medium",children:["@",r.telegram_bot_username]})]}),(0,t.jsx)(o.C,{variant:(null==C?void 0:C.is_active)?"default":"secondary",children:(null==C?void 0:C.is_active)?"Online":"Offline"})]}),(0,t.jsx)(c.z,{variant:"outline",size:"sm",asChild:!0,children:(0,t.jsxs)("a",{href:"https://t.me/".concat(r.telegram_bot_username),target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2",children:[(0,t.jsx)(y.Z,{className:"h-4 w-4"}),"Open Bot"]})})]})})]}),(0,t.jsxs)(u.bZ,{className:"mb-8",children:[(0,t.jsx)(N.Z,{className:"h-4 w-4"}),(0,t.jsxs)(u.X,{children:[(0,t.jsx)("strong",{children:"Enhanced Dashboard Features:"})," This dashboard now uses database storage instead of Google Sheets for better performance. Your bot supports commands like /today, /week, /month for instant expense queries!"]})]}),(0,t.jsxs)(f.mQ,{defaultValue:"analytics",className:"space-y-6",children:[(0,t.jsxs)(f.dr,{className:"grid w-full grid-cols-2",children:[(0,t.jsxs)(f.SP,{value:"analytics",className:"flex items-center gap-2",children:[(0,t.jsx)(w.Z,{className:"h-4 w-4"}),"Analytics"]}),(0,t.jsxs)(f.SP,{value:"expenses",className:"flex items-center gap-2",children:[(0,t.jsx)(Z.Z,{className:"h-4 w-4"}),"All Expenses"]})]}),(0,t.jsx)(f.nU,{value:"analytics",className:"space-y-6",children:(0,t.jsx)(m.Z,{userId:null==I?void 0:I.id})}),(0,t.jsx)(f.nU,{value:"expenses",className:"space-y-6",children:(0,t.jsx)(x.Z,{userId:null==I?void 0:I.id})})]}),(0,t.jsxs)(d.Zb,{className:"mt-8 border-yellow-200 bg-yellow-50",children:[(0,t.jsx)(d.Ol,{children:(0,t.jsx)(d.ll,{className:"text-yellow-800",children:"Database Migration Required"})}),(0,t.jsx)(d.aY,{children:(0,t.jsxs)(u.bZ,{children:[(0,t.jsx)(h.Z,{className:"h-4 w-4"}),(0,t.jsxs)(u.X,{children:[(0,t.jsx)("strong",{children:"Manual Step Required:"})," To see your expense data, run the SQL migration in your Supabase dashboard:",(0,t.jsx)("br",{}),(0,t.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded text-sm",children:"backend/migrations/add_expenses_table.sql"})]})]})})]})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-white p-4",children:(0,t.jsx)("div",{className:"max-w-2xl mx-auto pt-20",children:(0,t.jsxs)(d.Zb,{className:"shadow-xl",children:[(0,t.jsxs)(d.Ol,{className:"text-center",children:[(0,t.jsx)(d.ll,{className:"text-2xl text-blue-900",children:"Complete Your Setup"}),(0,t.jsx)(d.SZ,{children:"You need to configure your bot and AI settings before using the enhanced dashboard."})]}),(0,t.jsxs)(d.aY,{className:"space-y-4",children:[(0,t.jsxs)(u.bZ,{children:[(0,t.jsx)(h.Z,{className:"h-4 w-4"}),(0,t.jsx)(u.X,{children:"Your bot and Gemini AI need to be configured to view expense analytics."})]}),(0,t.jsxs)("div",{className:"flex gap-4 justify-center",children:[(0,t.jsx)(c.z,{asChild:!0,children:(0,t.jsx)(i.default,{href:"/setup",children:"Complete Setup"})}),(0,t.jsxs)(c.z,{variant:"outline",onClick:O,children:[(0,t.jsx)(g.Z,{className:"h-4 w-4 mr-2"}),"Sign Out"]})]})]})]})})})}},65613:function(e,s,r){"use strict";r.d(s,{X:function(){return o},bZ:function(){return d}});var t=r(57437),n=r(2265),a=r(90535),i=r(94508);let l=(0,a.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),d=n.forwardRef((e,s)=>{let{className:r,variant:n,...a}=e;return(0,t.jsx)("div",{ref:s,role:"alert",className:(0,i.cn)(l({variant:n}),r),...a})});d.displayName="Alert",n.forwardRef((e,s)=>{let{className:r,...n}=e;return(0,t.jsx)("h5",{ref:s,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",r),...n})}).displayName="AlertTitle";let o=n.forwardRef((e,s)=>{let{className:r,...n}=e;return(0,t.jsx)("div",{ref:s,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",r),...n})});o.displayName="AlertDescription"},35974:function(e,s,r){"use strict";r.d(s,{C:function(){return l}});var t=r(57437);r(2265);var n=r(90535),a=r(94508);let i=(0,n.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:s,variant:r,...n}=e;return(0,t.jsx)("div",{className:(0,a.cn)(i({variant:r}),s),...n})}},62869:function(e,s,r){"use strict";r.d(s,{z:function(){return o}});var t=r(57437),n=r(2265),a=r(37053),i=r(90535),l=r(94508);let d=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=n.forwardRef((e,s)=>{let{className:r,variant:n,size:i,asChild:o=!1,...c}=e,u=o?a.g7:"button";return(0,t.jsx)(u,{className:(0,l.cn)(d({variant:n,size:i,className:r})),ref:s,...c})});o.displayName="Button"},66070:function(e,s,r){"use strict";r.d(s,{Ol:function(){return l},SZ:function(){return o},Zb:function(){return i},aY:function(){return c},ll:function(){return d}});var t=r(57437),n=r(2265),a=r(94508);let i=n.forwardRef((e,s)=>{let{className:r,...n}=e;return(0,t.jsx)("div",{ref:s,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...n})});i.displayName="Card";let l=n.forwardRef((e,s)=>{let{className:r,...n}=e;return(0,t.jsx)("div",{ref:s,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",r),...n})});l.displayName="CardHeader";let d=n.forwardRef((e,s)=>{let{className:r,...n}=e;return(0,t.jsx)("h3",{ref:s,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",r),...n})});d.displayName="CardTitle";let o=n.forwardRef((e,s)=>{let{className:r,...n}=e;return(0,t.jsx)("p",{ref:s,className:(0,a.cn)("text-sm text-muted-foreground",r),...n})});o.displayName="CardDescription";let c=n.forwardRef((e,s)=>{let{className:r,...n}=e;return(0,t.jsx)("div",{ref:s,className:(0,a.cn)("p-6 pt-0",r),...n})});c.displayName="CardContent",n.forwardRef((e,s)=>{let{className:r,...n}=e;return(0,t.jsx)("div",{ref:s,className:(0,a.cn)("flex items-center p-6 pt-0",r),...n})}).displayName="CardFooter"},95186:function(e,s,r){"use strict";r.d(s,{I:function(){return i}});var t=r(57437),n=r(2265),a=r(94508);let i=n.forwardRef((e,s)=>{let{className:r,type:n,...i}=e;return(0,t.jsx)("input",{type:n,className:(0,a.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:s,...i})});i.displayName="Input"},2141:function(e,s,r){"use strict";r.d(s,{J:function(){return l}});var t=r(8439),n=r(95452);let a="***REMOVED***",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5obmRub3RxZ2RkbWNqYmdteHRqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzUwNzA5NDAsImV4cCI6MjA1MDY0Njk0MH0.kVG4Cz0WP5TcpmGJBe0jY-6yNIcrYRLVZ_LAfCwm0v4";if(!a||!i)throw Error("Missing Supabase environment variables");(0,t.eI)(a,i);let l=()=>(0,n.createClientComponentClient)()},94508:function(e,s,r){"use strict";r.d(s,{cn:function(){return a}});var t=r(61994),n=r(53335);function a(){for(var e=arguments.length,s=Array(e),r=0;r<e;r++)s[r]=arguments[r];return(0,n.m6)((0,t.W)(s))}},96362:function(e,s,r){"use strict";r.d(s,{Z:function(){return t}});let t=(0,r(39763).Z)("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]])},11239:function(e,s,r){"use strict";r.d(s,{Z:function(){return t}});let t=(0,r(39763).Z)("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]])}},function(e){e.O(0,[284,452,963,176,974,673,830,971,117,744],function(){return e(e.s=69133)}),_N_E=e.O()}]);